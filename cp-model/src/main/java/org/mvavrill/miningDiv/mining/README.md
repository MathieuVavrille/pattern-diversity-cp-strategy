This code is borrowed from https://github.com/lobnury/ClosedDiversity.
It has been improved:
- by removing rule 3 of the filtering of ClosedPattern
- adding a backtrackable structure
- refactoring